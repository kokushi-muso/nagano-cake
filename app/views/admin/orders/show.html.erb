<div class = "container">
  <div class=" pt-5">
    <h4 class="pb-3">注文履歴一覧</h4>
    <!--会員情報-->
      <%= flash[:success] %>
      <table class="table">
        <tbody>
        <tr>
        　<th>購入者</th>
        　<td>
          　<%= link_to admin_customer_path(@order) do %>
              <%= @order.customer.last_name+@order.customer.first_name %>
            <% end %>
          </td>
        </tr>
        <tr>
        　<th>注文日</th>
        　<td><%= @order.created_at.strftime('%Y/%m/%d') %></td>
        </tr>
        <tr>
        　<th>配送先</th>
        　<td>
        　    <span>
        　     〒 <%= @order.postcode %>
        　    <span>
        　    <span>
               <%= @order.address %>
             </span>
             <div>
        　      <%= @order.recieve_name %>
        　    </div>
          </td>
        </tr>
        <tr>
        　<th>支払い方法</th>
        　<td><%= @order.payment_method %></td>
        </tr>
        <tr>
        　<th>注文ステータス</th>
          <td>
    　       <%= form_with model: @order, url: admin_order_path(@order), method: :patch, local: true do |f| %>
              <div class="row">
              	<div class="col-2">
                  <div class="form-group">
                    <%= f.select :order_status, Order.order_statuses.keys, class: "order_statusc form-control" %>
                  </div>
                </div>
                <div class="col-2 align-self-end">
                  <div class="form-group">
                    <%= f.submit '更新'  ,class: "btn btn-success ml-5" %>
                  </div>
                </div>
              </div>
            <% end %>
          </td>
        </tr>
        </tbody>
      </table>

      <!--商品情報-->
      <div class="admin-order-bottom row mt-5 w-100">
        <table class="table admin-order-items col-md-8">
          <tr>
            <th class="table-active">商品名</th>
            <th class="table-active">単価(税込)</th>
            <th class="text-center table-active">数量</th>
            <th class="text-center table-active">小計</th>
            <th class="table-active">製作ステータス</th>
          </tr>
          <tr>
            <% @order_items.each do |item| %>
              <td><%= item.item.name %></td>
              <td><%= item.price_including_tax %></td>
              <td><%= item.quantity %></td>
              <td><%= item.quantity * item.price_including_tax %></td>
              <td>
                <%= form_with model: item, url: admin_order_order_item_path(item), method: :patch, local: true do |f| %>
                  <div class="row">
                  	<div class="col-2">
                      <div class="form-group">
                        <%= f.select :product_status, OrderItem.product_statuses.keys, class: "product_status" %>
                      </div>
                    </div>
                    <div class="col-2 align-self-end">
                      <div class="form-group">
                        <%= f.submit '更新'  ,class: "btn btn-primary ml-5" %>
                      </div>
                    </div>
                  </div>
                <% end %>
              </td>
            <% end %>
          </tr>
        </table>
        <!--料金情報-->
        <table class="admin-order-details col-md-3 ml-auto mt-auto admin-customer-show">
          <tr>
            <th>商品合計</th>
            <td  class="text-right">
              ¥<%= @order.total_price.to_s(:delimited) %>
            </td>
          </tr>
          <tr>
            <th>配送料</th>
            <td class="text-right">
              ¥<%= @order.shipping_fee %>
            </td>
          </tr>
          <tr>
            <th>ご請求額</th>
            <td class="text-right">
              ¥<%= (@order.total_price.to_i + @order.shipping_fee.to_i).to_s(:delimited) %>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>